(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{CCjs:function(t,e,r){"use strict";var n=r("ttp2"),o=r("L2JU");function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s={components:{ValidationError:n.a},props:{curation:{required:!0,type:Object}},data:function(){return{showModal:!1,categories:[],newUpload:{},errors:{},uploading:!1}},computed:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},Object(o.c)({maxUploadSize:"getMaxUploadSize",supportedMimes:"getSupportedMimes"})),methods:{getUploadCategories:function(){var t=this;window.axios.get("/api/upload-categories").then((function(e){return t.categories=e.data.data}))},initNewUpload:function(){this.newUpload={name:"",upload_category_id:"",notes:""}},initErrors:function(){this.errors={}},clearForm:function(){this.initNewUpload(),this.initErrors()},prepopulateName:function(){""==this.newUpload.name&&(this.newUpload.name=this.$refs.uploadField.files[0].name)},uploadFile:function(t){var e=this;this.initErrors(),t.preventDefault();var r=new FormData;return r.append("curation_id",this.curation.id),r.append("name",this.newUpload.name),r.append("file",this.$refs.uploadField.files[0]),r.append("upload_category_id",this.newUpload.upload_category_id),r.append("notes",this.newUpload.notes),this.uploading=!0,window.axios.post("/api/curations/".concat(this.curation.id,"/uploads"),r,{headers:{"Content-Type":"multipart/form-data"}}).then((function(t){e.$emit("uploaded"),e.clearForm(),e.$nextTick((function(){return e.$refs.uploadModal.hide()}))})).catch((function(t){422!=t.response.status?413!=t.response.status?alert("There was an unkown problem with your file upload."):e.errors={file:["The file was too large"]}:e.errors=t.response.data.errors})).then((function(){e.uploading=!1}))},launchFileSelector:function(){this.$refs.uploadField.click()}},mounted:function(){this.getUploadCategories(),this.initNewUpload(),this.initErrors()}},l=r("KHd+"),c=Object(l.a)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mb-2"},[r("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){t.showModal=!0}}},[t._v("Add Document")]),t._v(" "),r("b-modal",{ref:"uploadModal",attrs:{title:"Upload a Document","ok-disabled":t.uploading,"cancel-disabled":t.uploading,"ok-title":t.uploading?"Uploading...":"Upload"},on:{ok:t.uploadFile,cancel:t.clearForm},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[r("div",{staticClass:"form-row"},[r("label",{staticClass:"col-sm-2",attrs:{for:"file-field"}},[t._v("\n                File:\n            ")]),t._v(" "),r("div",{staticClass:"col-sm-10"},[r("div",{staticClass:"d-flex justify-content-between"},[r("div",[r("input",{ref:"uploadField",staticClass:"form-control-file",attrs:{type:"file",id:"file-field",disabled:t.uploading},on:{change:function(e){return t.prepopulateName()}}})]),t._v(" "),r("div",[r("small",{directives:[{name:"b-toggle",rawName:"v-b-toggle.file-info-collapse",modifiers:{"file-info-collapse":!0}}],staticClass:"text-secondary material-icons cursor-pointer"},[t._v("info")])])]),t._v(" "),r("b-collapse",{attrs:{id:"file-info-collapse"}},[r("div",[r("small",{staticClass:"text-muted"},[t._v("Supported types: "+t._s(t.supportedMimes.join(", ")))])]),t._v(" "),r("div",[r("small",{staticClass:"text-muted"},[t._v("Max size: "+t._s(t.maxUploadSize))])])]),t._v(" "),r("validation-error",{attrs:{messages:t.errors.file}})],1)]),t._v(" "),r("div",{staticClass:"form-row"},[r("label",{staticClass:"col-sm-2",attrs:{for:"name"}},[t._v("Name:")]),t._v(" "),r("div",{staticClass:"col-sm-10"},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.newUpload.name,expression:"newUpload.name"}],staticClass:"form-control form-control-sm",attrs:{type:"text",id:"name",maxlength:"255",disabled:t.uploading},domProps:{value:t.newUpload.name},on:{input:function(e){e.target.composing||t.$set(t.newUpload,"name",e.target.value)}}}),t._v(" "),r("validation-error",{attrs:{messages:t.errors.name}})],1)]),t._v(" "),t.categories.length>0?r("div",{staticClass:"form-row"},[r("label",{staticClass:"col-sm-2",attrs:{for:"category_id"}},[t._v("Category:")]),t._v(" "),r("div",{staticClass:"col-sm-10"},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.newUpload.upload_category_id,expression:"newUpload.upload_category_id"}],staticClass:"form-control form-control-sm",attrs:{name:"category_id",id:"category_id",disabled:t.uploading},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.newUpload,"upload_category_id",e.target.multiple?r:r[0])}}},[r("option",{attrs:{value:""}},[t._v("None")]),t._v(" "),t._l(t.categories,(function(e){return r("option",{key:e.id,domProps:{value:e.id}},[t._v("\n                        "+t._s(e.name)+"\n                    ")])}))],2),t._v(" "),r("validation-error",{attrs:{messages:t.errors.upload_category_id}})],1)]):t._e(),t._v(" "),r("div",{staticClass:"form-row"},[r("label",{staticClass:"col-sm-2",attrs:{for:"notes"}},[t._v("\n                Notes:\n            ")]),t._v(" "),r("div",{staticClass:"col-sm-10"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:t.newUpload.notes,expression:"newUpload.notes"}],staticClass:"form-control form-control-sm",attrs:{name:"notes",id:"notes",cols:"30",rows:"5",maxlegnth:"65535",disabled:t.uploading},domProps:{value:t.newUpload.notes},on:{input:function(e){e.target.composing||t.$set(t.newUpload,"notes",e.target.value)}}}),t._v(" "),r("validation-error",{attrs:{messages:t.errors.notes}})],1)])])],1)}),[],!1,null,null,null).exports,u=r("o0o1"),d=r.n(u),p=r("Uv7m");function f(t,e,r,n,o,a,i){try{var s=t[a](i),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function m(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){f(a,n,o,i,s,"next",t)}function s(t){f(a,n,o,i,s,"throw",t)}i(void 0)}))}}var v=function(t){return h.apply(this,arguments)};function h(){return(h=m(d.a.mark((function t(e){var r,n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.where.curation_id,n="/api/curations/"+r+"/uploads",t.next=4,axios.get(n+(e?"?"+Object(p.a)(e):"")).then((function(t){return t.data.data}));case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function b(t,e,r,n,o,a,i){try{var s=t[a](i),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function _(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function g(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var w={components:{DocumentUploader:c},props:{curation:{reqired:!0,type:Object}},data:function(){var t=this;return{showDetailedInfo:!1,loadingDocuments:!1,documents:[],currentDocument:null,filter:"",fields:[{key:"id",sortable:!0},{key:"name",sortable:!0},{key:"category.name",sortable:!0,label:"Category"},{key:"created_at",label:"Created",sortable:!0,formatter:function(e,r,n){return t.$options.filters.formatDate(e,"YYYY-MM-DD")}},{key:"uploader.name",label:"Uploaded by",sortable:!0},"action"],filteredFields:["name","id","category","uploader","uploader"]}},computed:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?_(Object(r),!0).forEach((function(e){g(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},Object(o.c)({user:"getUser"})),watch:{curation:function(){this.getDocuments()}},methods:{getDocuments:function(){var t,e=this;return(t=d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.curation.id){t.next=2;break}return t.abrupt("return");case 2:return e.loadingDocuments=!0,t.next=5,v({with:["category","uploader"],where:{curation_id:e.curation.id}});case 5:e.documents=t.sent,e.loadingDocuments=!1;case 7:case"end":return t.stop()}}),t)})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){b(a,n,o,i,s,"next",t)}function s(t){b(a,n,o,i,s,"throw",t)}i(void 0)}))})()},showDetails:function(t){this.currentDocument=t,this.showDetailedInfo=!0},downloadFile:function(t){axios.get("/api/curations/"+this.curation.id+"/uploads/"+t.id+"/file",{responseType:"blob"}).then((function(e){console.log(e.data);var r=e.data,n=window.document.createElement("a"),o=window.URL.createObjectURL(r);n.href=o,n.download=t.name,window.document.body.append(n),n.click(),n.remove(),window.URL.revokeObjectURL(o)})).catch((function(t){if(!t.response||404!=t.response.status)throw t;alert("We couldn't seem to find the file you requested.")}))},deleteDocument:function(t){var e=this;confirm("Are you sure you want to delete the document "+t.name+"?")&&(this.documents.splice(this.documents.findIndex((function(e){return e.id=t.id})),1),axios.delete("/api/curations/"+this.curation.id+"/uploads/"+t.id).then((function(t){})).catch((function(t){e.getDocuments(),alert("There was a problem deleting the document.  Contact the administrator if the problem persists.")})))}},mounted:function(){this.getDocuments()}};function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function O(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var D={components:{DocumentUploader:c,DocumentsList:Object(l.a)(w,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[t.loadingDocuments?r("div",{staticClass:"alert alert-info"},[t._v("Loading...")]):t._e(),t._v(" "),t.loadingDocuments||0!=t.documents.length?t._e():r("div",{staticClass:"alert alert-light border"},[t._v("\n        No documents found\n    ")]),t._v(" "),t.documents.length>0?r("div",[r("div",{staticClass:"form-inline mb-1"},[r("label",{attrs:{for:"list-filter-input"}},[t._v("Filter:")]),t._v(" \n            "),r("input",{directives:[{name:"model",rawName:"v-model",value:t.filter,expression:"filter"}],staticClass:"form-control form-control-sm",attrs:{type:"text"},domProps:{value:t.filter},on:{input:function(e){e.target.composing||(t.filter=e.target.value)}}})]),t._v(" "),r("b-table",{attrs:{fields:t.fields,items:t.documents,filter:t.filter,"filter-included-fields":t.filteredFields,stacked:"sm"},scopedSlots:t._u([{key:"cell(action)",fn:function(e){var n=e.item;return[r("a",{attrs:{href:"#",title:"Download document"},on:{click:function(e){return e.preventDefault(),t.downloadFile(n)}}},[r("i",{staticClass:"material-icons"},[t._v("cloud_download")])]),t._v(" "),r("a",{attrs:{href:"#",title:"Detailed information"},on:{click:function(e){return e.preventDefault(),t.showDetails(n)}}},[r("i",{staticClass:"material-icons"},[t._v("info")])]),t._v(" "),t.user.canEditCuration(t.curation)?r("a",{staticClass:"text-danger",attrs:{href:"#",title:"Delete document"},on:{click:function(e){return e.preventDefault(),t.deleteDocument(n)}}},[r("i",{staticClass:"material-icons"},[t._v("delete")])]):t._e()]}}],null,!1,2771667464)})],1):t._e(),t._v(" "),t.currentDocument?r("b-modal",{attrs:{"hide-footer":"",title:t.currentDocument.name,size:"lg"},model:{value:t.showDetailedInfo,callback:function(e){t.showDetailedInfo=e},expression:"showDetailedInfo"}},[r("dl",{staticClass:"row"},[r("dt",{staticClass:"col-md-2"},[t._v("Name:")]),t._v(" "),r("dd",{staticClass:"col-md-10"},[t._v(t._s(t.currentDocument.name))]),t._v(" "),r("dt",{staticClass:"col-md-2"},[t._v("File name:")]),t._v(" "),r("dd",{staticClass:"col-md-10"},[t._v(t._s(t.currentDocument.file_name?t.currentDocument.file_name:"--"))]),t._v(" "),r("dt",{staticClass:"col-md-2"},[t._v("Category:")]),t._v(" "),r("dd",{staticClass:"col-md-10"},[t._v(t._s(t.currentDocument.category?t.currentDocument.category.name:"--"))]),t._v(" "),r("dt",{staticClass:"col-md-2"},[t._v("Date uploaded:")]),t._v(" "),r("dd",{staticClass:"col-md-10"},[t._v(t._s(t._f("formatDate")(t.currentDocument.created_at,"YYYY-MM-DD")))]),t._v(" "),r("dt",{staticClass:"col-md-2"},[t._v("Uploaded by:")]),t._v(" "),r("dd",{staticClass:"col-md-10"},[t._v(t._s(t.currentDocument.uploader?t.currentDocument.uploader.name:"--"))]),t._v(" "),r("dt",{staticClass:"col-md-2"},[t._v("Notes:")]),t._v(" "),r("dd",{staticClass:"col-md-10"},[t._v(t._s(t.currentDocument.notes?t.currentDocument.notes:"--"))])]),t._v(" "),r("div",{staticClass:"mt-2"},[r("button",{staticClass:"btn btn-primary text-middle btn-sm",attrs:{title:"Download document"},on:{click:function(e){return t.downloadFile(t.currentDocument)}}},[t._v("\n                Download document\n            ")])])]):t._e()],1)}),[],!1,null,null,null).exports},props:{curation:{reqired:!0,type:Object}},data:function(){return{}},computed:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach((function(e){O(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},Object(o.c)({user:"getUser"})),methods:{}},C=Object(l.a)(D,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("h4",[t.user.canEditCuration(t.curation)?r("document-uploader",{staticClass:"float-right",attrs:{curation:t.curation},on:{uploaded:function(e){return t.$refs.docList.getDocuments()}}}):t._e(),t._v("\n        Documents\n    ")],1),t._v(" "),r("documents-list",{ref:"docList",attrs:{curation:t.curation}})],1)}),[],!1,null,null,null);e.a=C.exports},FD4A:function(t,e,r){"use strict";var n=r("wd/R"),o=r.n(n),a=(r("XuAf"),{props:{curation:{type:Object,required:!0}},computed:{orderedClassifications:function(){return this.curation.classifications?this.curation.classifications.concat().sort((function(t,e){return o()(t.pivot.classification_date).isSame(e.pivot.classification_date)?t.id==e.id?0:t.id<e.id?1:-1:o()(t.pivot.classification_date).isBefore(e.pivot.classification_date)?1:-1})):[]}}}),i=(r("Stug"),r("KHd+")),s=Object(i.a)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"curation-classification-history"},[r("table",{staticClass:"table table-bordered table-small"},[t._m(0),t._v(" "),t._l(t.orderedClassifications,(function(e,n){return r("tr",{key:e.pivot.id,class:{"table-primary highlight":0==n}},[r("td",[t._v(t._s(e.name))]),t._v(" "),r("td",[t._v(t._s(t._f("formatDate")(e.pivot.classification_date,"YYYY-MM-DD")))])])}))],2)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("th",[this._v("Classification")]),this._v(" "),e("th",[this._v("Date")])])}],!1,null,"45066372",null);e.a=s.exports},RDmU:function(t,e,r){"use strict";var n=r("wd/R"),o=r.n(n),a=(r("XuAf"),{props:{curation:{type:Object,required:!0}},computed:{orderedStatuses:function(){return this.curation.curation_statuses?this.curation.curation_statuses.concat().sort((function(t,e){return o()(t.pivot.status_date).isSame(e.pivot.status_date)?t.id==e.id?0:t.id<e.id?1:-1:o()(t.pivot.status_date).isBefore(e.pivot.status_date)?1:-1})):[]}}}),i=(r("Vb8l"),r("KHd+")),s=Object(i.a)(a,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"curation-status-history"},[r("table",{staticClass:"table table-bordered table-small"},[t._m(0),t._v(" "),t._l(t.orderedStatuses,(function(e,n){return r("tr",{key:e.pivot.id,class:{"table-primary highlight":0==n}},[r("td",[t._v(t._s(e.name))]),t._v(" "),r("td",[t._v(t._s(t._f("formatDate")(e.pivot.status_date,"YYYY-MM-DD")))])])}))],2)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("tr",[e("th",[this._v("Status")]),this._v(" "),e("th",[this._v("Date")])])}],!1,null,"329ba673",null);e.a=s.exports},Stug:function(t,e,r){"use strict";r("Yn47")},Vb8l:function(t,e,r){"use strict";r("ZmI2")},Wmfs:function(t,e,r){(t.exports=r("I1BE")(!1)).push([t.i,"tr.highlight td[data-v-45066372]{font-weight:700}",""])},XuAf:function(t,e,r){"use strict";var n=r("XuX8"),o=r.n(n),a=r("wd/R"),i=r.n(a);o.a.filter("formatDate",(function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD HH:mm";return null===t?null:i()(t).format(e)}))},Yn47:function(t,e,r){var n=r("Wmfs");"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(n,o);n.locals&&(t.exports=n.locals)},ZmI2:function(t,e,r){var n=r("ntFs");"string"==typeof n&&(n=[[t.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};r("aET+")(n,o);n.locals&&(t.exports=n.locals)},"dnW+":function(t,e){var r=function(t){var e=[];for(var r in t)e.push(r+"="+t[r]);return"?"+e.join("&")};t.exports={baseUrl:null,name:"BaseRepository",dates:[],makeRequest:function(t,e,r){if(!e)throw"No url";var n={method:t=t||"GET",url:e};return r&&(n.data=r),window.axios(n)},all:function(t){var e=this.baseUrl+r(t);return this.makeRequest("get",e).then(function(t){return{data:t.data.map(function(t){return this.transformDates(t)}.bind(this)),status:t.status,headers:t.headers,request:t.request,statusText:t.statusText,config:t.config}}.bind(this)).catch(function(t){var e;return e="Unable to retrieve "+this.name,console.error(e),alert("There was a problem: "+e+". Please notify the development team."),t}.bind(this))},find:function(t,e){var n=this.baseUrl+"/"+t+r(e);return this.makeRequest("get",n).then(function(t){return t.data=this.transformDates(t.data),t}.bind(this))},save:function(t){for(var e in t)t[e]&&t[e]._isAMomentObject?t[e]=t[e].format("YYYY-MM-DD HH:mm:ss"):this.dates.indexOf(e)>-1&&(t[e]=moment(t[e]).format("YYYY-MM-DD HH:mm:ss"));return t.id?this.update(t):this.store(t)},store:function(t){return this.makeRequest("post",this.baseUrl,t).then(function(t){return t.data=this.transformDates(t.data),t}.bind(this))},update:function(t){return this.makeRequest("put",this.baseUrl+"/"+t.id,t)},destroy:function(t){return this.makeRequest("delete",this.baseUrl+"/"+t)},transformDates:function(t){var e={};for(var r in t)this.dates.indexOf(r)>-1?e[r]=moment(t[r]):e[r]=t[r];return e}}},iWAU:function(t,e,r){"use strict";var n=r("o0o1"),o=r.n(n),a=r("L2JU"),i=r("ttp2"),s={props:{errors:{type:Array,required:!0}}},l=r("KHd+"),c={props:{value:{required:!1,default:null}},emits:["update:modelValue"],data:function(){return{}},computed:{formattedDate:function(){if(!this.value)return null;var t=this.formatDate(this.value);return console.log(t),t}},methods:{setDate:function(t){var e=new Date(Date.parse(t.target.value)),r=new Date(e.getTime()+60*e.getTimezoneOffset()*1e3);this.$emit("input",r)},formatDate:function(t){var e=new Date(t),r=""+(e.getMonth()+1),n=""+e.getDate(),o=e.getFullYear();return r.length<2&&(r="0"+r),n.length<2&&(n="0"+n),[o,r,n].join("-")}}},u={components:{InputErrors:Object(l.a)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{staticClass:"text-danger list-unstyled pt-0 mt-0"},t._l(t.errors,(function(e){return r("li",{key:e},[t._v(t._s(e))])})),0)}),[],!1,null,null,null).exports,DateInput:Object(l.a)(c,(function(){var t=this.$createElement,e=this._self._c||t;return e("div",[e("input",{staticClass:"form-control",attrs:{type:"date"},domProps:{value:this.formattedDate},on:{input:this.setDate}})])}),[],!1,null,null,null).exports},props:{vertical:{type:Boolean,default:!1},errors:{type:Array,required:!1,default:function(){return[]}},label:{type:String,required:!1},type:{type:String,required:!1,default:"text"},value:{required:!1,default:null},placeholder:{required:!1,value:null}},emits:["update:modelValue"],computed:{colon:function(){return this.label&&[":",";",".","?","!"].includes(this.label.substr(-1))?"":":"},hasErrors:function(){return this.errors.length>0}},methods:{emitValue:function(t){console.log(t),this.$emit("input",t)}}},d=Object(l.a)(u,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"my-3",class:{"d-flex":!t.vertical}},[r("div",{class:{"w-25":!t.vertical,"my-1":t.vertical}},[t.label?t._t("label",[r("label",{class:{"text-red-800":t.hasErrors}},[t._v(t._s(t.label)+t._s(t.colon))])]):t._e()],2),t._v(" "),r("div",[t._t("default",["date"==t.type?r("date-input",{attrs:{value:t.value},on:{input:t.emitValue}}):r("input",{attrs:{type:t.type,placeholder:t.placeholder},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}})]),t._v(" "),r("input-errors",{attrs:{errors:t.errors}})],2)])])}),[],!1,null,null,null).exports,p=r("jN9E");function f(t,e,r,n,o,a,i){try{var s=t[a](i),l=s.value}catch(t){return void r(t)}s.done?e(l):Promise.resolve(l).then(n,o)}function m(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function v(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?m(Object(r),!0).forEach((function(e){h(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):m(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var b={components:{ValidationError:i.a,InputRow:d,GciLink:p.a},props:{curation:{type:Object,required:!0}},emits:["submited","canceled"],data:function(){return{showTransferForm:!1,newExpertPanel:{coordinators:[]},startDate:null,isHistorical:null,endDate:null,errors:{},showConfirmation:!1}},computed:v(v({},Object(a.c)("panels",{panels:"Items"})),{},{filteredPanels:function(){var t=this;return this.panels.filter((function(e){return e.id!=t.curation.expert_panel_id}))},inGci:function(){return Boolean(this.curation.gdm_uuid)}}),methods:v(v(v({},Object(a.b)("panels",{getAllPanels:"getAllItems",getPanel:"getItem"})),Object(a.b)("curations",{updateOwner:"updateOwner"})),{},{confirmTransfer:function(){this.showConfirmation=!0},transferCuration:function(){var t,e=this;return(t=o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.updateOwner({curation:e.curation,expertPanelId:e.newExpertPanel.id,startDate:e.startDate});case 3:e.showTransferForm=!1,e.showConfirmation=!1,t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),(r=t.t0).response&&422==r.response.status&&r.response.data.errors&&(e.errors=t.t0.response.data.errors),e.showConfirmation=!1;case 11:case"end":return t.stop()}var r}),t,null,[[0,7]])})),function(){var e=this,r=arguments;return new Promise((function(n,o){var a=t.apply(e,r);function i(t){f(a,n,o,i,s,"next",t)}function s(t){f(a,n,o,i,s,"throw",t)}i(void 0)}))})()},cancel:function(){this.showTransferForm=!1,this.initFormData()},initFormData:function(){this.newExpertPanel={coordinators:[]},this.startDate=null,this.isHistorical=null,this.endDate=null,this.errors={},this.showConfirmation=!1},fieldError:function(t){return this.errors&&this.errors[t]&&this.errors[t].length>0}}),mounted:function(){this.getAllPanels({with:["coordinators"]})}},_=Object(l.a)(b,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("button",{staticClass:"btn btn-sm bg-white border",on:{click:function(e){t.showTransferForm=!0}}},[t._v("\n        Transfer Curation\n    ")]),t._v(" "),r("b-modal",{attrs:{title:"Transfer Curation Ownership","hide-footer":!0},model:{value:t.showTransferForm,callback:function(e){t.showTransferForm=e},expression:"showTransferForm"}},[t.inGci?r("div",{staticClass:"alert alert-secondary"},[r("p",[t._v("This pre-curation is linked to a record in the GCI.  To transfer this record to another expert panel please contact GCI support at "),r("a",{attrs:{href:"mailto:clingen-helpdesk@lists.stanford.edu"}},[t._v("clingen-helpdesk@lists.stanford.edu")])]),t._v(" "),r("gci-link",{attrs:{curation:t.curation}},[t._v("Go to the GCI record.")])],1):r("div",[r("div",{staticClass:"alert alert-info"},[t._v("\n                    Before transfering this record, be sure that you have contacted the coordinator receiving the curation.\n                ")]),t._v(" "),r("input-row",{attrs:{label:"Transfer to:",errors:t.errors.expert_panel_id}},[r("select",{directives:[{name:"model",rawName:"v-model",value:t.newExpertPanel,expression:"newExpertPanel"}],staticClass:"form-control-sm w-75",attrs:{id:"expert-panel-select"},on:{change:function(e){var r=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.newExpertPanel=e.target.multiple?r:r[0]}}},[r("option",{domProps:{value:null}},[t._v("Select...")]),t._v(" "),t._l(t.panels,(function(e){return r("option",{key:e.id,domProps:{value:e}},[t._v("\n                            "+t._s(e.name)+"\n                        ")])}))],2)]),t._v(" "),r("input-row",{attrs:{errors:t.errors.start_date,label:"Transfer date",type:"date"},model:{value:t.startDate,callback:function(e){t.startDate=e},expression:"startDate"}}),t._v(" "),r("div",{staticClass:"mt-1 border-top pt-3 text-right"},[r("button",{staticClass:"btn btn-secondary",on:{click:t.cancel}},[t._v("Cancel")]),t._v(" "),r("button",{staticClass:"btn btn-primary",on:{click:function(e){return t.confirmTransfer()}}},[t._v("Transfer Curation")])])],1)]),t._v(" "),r("b-modal",{attrs:{title:"Confirm Curation Transfer","hide-footer":!0},model:{value:t.showConfirmation,callback:function(e){t.showConfirmation=e},expression:"showConfirmation"}},[r("div",{staticClass:"alert alert-info"},[r("div",{staticClass:"lead"},[t._v("You are about to transfer this curation to "+t._s(t.newExpertPanel.name)+".")]),t._v("\n            \n            Please be sure that you have communicated with the EP coordinator(s) before you continue.\n            "),r("ul",t._l(t.newExpertPanel.coordinators,(function(e){return r("li",{key:e.id},[t._v("\n                    "+t._s(e.name)+" <"),r("a",{attrs:{href:"mailto:"+e.email}},[t._v(t._s(e.email))]),t._v(">\n                ")])})),0)]),t._v(" "),r("div",{staticClass:"mt-1 border-top pt-3 text-right"},[r("button",{staticClass:"btn btn-secondary",on:{click:t.cancel}},[t._v("Cancel")]),t._v(" "),r("button",{staticClass:"btn btn-primary",on:{click:t.transferCuration}},[t._v("Transfer Curation")])])])],1)}),[],!1,null,null,null);e.a=_.exports},j6Wa:function(t,e,r){"use strict";var n=r("L2JU");function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function a(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){i(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function i(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var s={props:{curation:{required:!0,type:Object}},data:function(){return{}},computed:a(a({},Object(n.c)({user:"getUser"})),{},{title:function(){var t="";return this.curation&&this.curation.gene_symbol&&(t+=this.curation.gene_symbol,this.curation.mondo_id&&(t+=" / "+this.curation.mondo_id),this.curation.expert_panel&&(t+=" for "+this.curation.expert_panel.name)),t}}),methods:a(a(a({},Object(n.b)("curations",{destroyCuration:"destroyItem"})),Object(n.d)("messages",["addInfo","addError"])),{},{deleteCuration:function(){var t=this;if(confirm("You're about to delete "+this.title+". This can not be undone.  Are you sure you want to continue?")){this.$router.push("/");var e=this.title;this.destroyCuration(this.curation.id).then((function(r){t.addInfo(e+" was successfully deleted.")})).catch((function(r){var n="There was a problem deleting"+e;403==r.response.status&&(n="You do not have permissions to delete curations.  Please contact an adminstrator to help you delete the curation."),t.addError(n)}))}}})},l=r("KHd+"),c=Object(l.a)(s,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.user.canDeleteCuration(t.curation)?r("button",{staticClass:"btn btn-danger",attrs:{id:"delete-curation-"+t.curation.id+"-btn"},on:{click:function(e){return t.deleteCuration(t.curation)}}},[t._t("default",[t._v("Delete")])],2):t._e()}),[],!1,null,null,null);e.a=c.exports},ntFs:function(t,e,r){(t.exports=r("I1BE")(!1)).push([t.i,"tr.highlight td[data-v-329ba673]{font-weight:700}",""])},ttp2:function(t,e,r){"use strict";var n={props:["messages"],computed:{hasErrors:function(){return void 0!==this.messages}}},o=r("KHd+"),a=Object(o.a)(n,(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("transition",{attrs:{name:"fade"}},[r("div",{directives:[{name:"show",rawName:"v-show",value:t.hasErrors,expression:"hasErrors"}],staticClass:"text-danger mt-1"},t._l(t.messages,(function(e,n){return r("div",{key:n},[r("small",[t._v(t._s(e))])])})),0)])}),[],!1,null,null,null);e.a=a.exports},vlNi:function(t,e,r){var n=r("dnW+"),o=Object.create(n);o.baseUrl="/api/omim",o.all=function(t){throw"all method is not supported"},o.all=function(t){throw'"all" method is not supported'},o.store=function(t){throw'"store" method is not supported'},o.update=function(t){throw'"update" method is not supported'},o.destroy=function(t){throw'"destroy" method is not supported'},o.entry=function(t){return this.makeRequest("get",this.baseUrl+"/entry?mim_number="+t)},o.search=function(t){return this.makeRequest("get",this.baseUrl+"/search?search="+t)},o.gene=function(t){return this.makeRequest("get",this.baseUrl+"/gene/"+t)},t.exports=o}}]);
//# sourceMappingURL=CurationEdit~CurationShow.faf45014212373710513.js.map