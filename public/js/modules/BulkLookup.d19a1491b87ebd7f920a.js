(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{"+Fwk":function(t,e,n){"use strict";n("gkCk")},"+bMS":function(t,e,n){"use strict";var r={props:["value","errors"],data:function(){return{currentTab:0,hasHeader:!1}},computed:{numericCurrentTab:{get:function(){return parseInt(this.currentTab)},set:function(t){this.currentTab=t}}},watch:{currentTab:function(t,e){localStorage.setItem("bulk-upload-form-tab-index",t)}},methods:{processFile:function(t){var e=this;if(t.length>0&&"text/csv"==t[0].type){var n=new FileReader;n.addEventListener("load",(function(t){var n=t.target.result;if(e.hasHeader){var r=n.split("\n");r.splice(0,1);e.$emit("input",r.join(","))}else e.$emit("input",n)})),n.addEventListener("progress",(function(t){if(t.loaded&&t.total){var e=t.loaded/t.total*100;console.log("progress: ".concat(Math.round(e)))}})),n.readAsText(t[0])}}},mounted:function(){var t=localStorage.getItem("bulk-upload-form-tab-index");this.currentTab=t||0}},s=n("KHd+"),a=Object(s.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-tabs",{staticClass:"border",attrs:{vertical:"",pills:"",card:""},model:{value:t.numericCurrentTab,callback:function(e){t.numericCurrentTab=e},expression:"numericCurrentTab"}},[n("b-tab",{attrs:{title:"Manual entry"}},[n("label",{attrs:{for:"gene-symbol-input"}},[t._v("Gene Symbols:")]),t._v("\n            Â \n            "),n("textarea",{staticClass:"form-control",attrs:{cols:"10",rows:"3",id:"gene-symbol-input",maxlength:"1900",placeholder:"Comma, space, or new-line separated gene symboels, i.e.: BCRA1, TP53 ABSC"},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)}}}),t._v(" "),n("div",{staticClass:"mt-1"},[n("button",{staticClass:"btn btn-sm btn-light border",on:{click:function(e){return t.$emit("input","")}}},[t._v("Clear")]),t._v(" "),n("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){return t.$emit("lookup")}}},[t._v("Search")]),t._v(" "),n("button",{staticClass:"btn btn-primary btn-sm float-right",on:{click:function(e){return t.$emit("getCsv")}}},[t._v("Get CSV")])])]),t._v(" "),n("b-tab",{attrs:{title:"CSV Upload"}},[n("div",[n("label",{attrs:{for:"csv-upload"}},[t._v("CSV file: ")]),t._v(" "),n("input",{staticClass:"d-block",attrs:{type:"file",accept:"csv",id:"csv-upload"},on:{change:function(e){return t.processFile(e.target.files)}}}),t._v(" "),n("div",{staticClass:"text-info text-small"},[n("small",[t._v("File should contain a single column with gene symbols.")])]),t._v(" "),n("div",{staticClass:"form-check my-2"},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.hasHeader,expression:"hasHeader"}],staticClass:"form-check-input",attrs:{type:"checkbox",id:"has-header"},domProps:{checked:Array.isArray(t.hasHeader)?t._i(t.hasHeader,null)>-1:t.hasHeader},on:{change:function(e){var n=t.hasHeader,r=e.target,s=!!r.checked;if(Array.isArray(n)){var a=t._i(n,null);r.checked?a<0&&(t.hasHeader=n.concat([null])):a>-1&&(t.hasHeader=n.slice(0,a).concat(n.slice(a+1)))}else t.hasHeader=s}}}),t._v(" "),n("label",{staticClass:"form-check-label",attrs:{for:"has-header"}},[t._v(" has header row")])])]),t._v(" "),n("div",{staticClass:"mt-2"},[n("button",{staticClass:"btn btn-primary btn-sm",on:{click:function(e){return t.$emit("lookup")}}},[t._v("Search")]),t._v(" "),n("button",{staticClass:"btn btn-primary btn-sm float-right",on:{click:function(e){return t.$emit("getCsv")}}},[t._v("Get CSV")])])])],1)],1)}),[],!1,null,null,null);e.a=a.exports},"2Xr8":function(t,e,n){"use strict";n("5FTD")},"5FTD":function(t,e,n){var r=n("yAls");"string"==typeof r&&(r=[[t.i,r,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,s);r.locals&&(t.exports=r.locals)},CiND:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,".phenotype[data-v-a7cc2a54]{color:#666;margin-bottom:.5rem}.phenotype.curated[data-v-a7cc2a54]{color:#000}",""])},gXzZ:function(t,e,n){"use strict";n.r(e);var r=n("wd/R"),s=n.n(r),a=n("+bMS"),i=n("wCxy");function l(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"==typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var c={components:{LookupForm:a.a,FilterControl:i.a},props:{},data:function(){return{geneSymbols:[],results:[],fields:[{key:"gene_symbol",label:"Gene",sortable:!0},{key:"mondo_name",label:"Disease Entity",formatter:function(t,e,n){return t?"".concat(n.mondo_name," (").concat(n.mondo_id,")"):null},sortable:!0,thStyle:{width:"12rem"}},{key:"expert_panel.name",label:"Expert Panel",sortable:!0},{key:"current_classification.name",label:"Classification",sortable:!0,formatter:function(t,e,n){var r=t;return n.current_classification&&(r+=" - ".concat(s()(n.current_classification.pivot.classification_date).format("MM/DD/YY"))),r},thStyle:{width:"10rem"}},{key:"current_status.name",label:"Status",sortable:!0,formatter:function(t,e,n){var r=t;return n.current_status_date&&(r+=" - ".concat(s()(n.current_status_date).format("MM/DD/YY"))),r},thStyle:{width:"10rem"}},{key:"updated_at",label:"Updated",sortable:!0,formatter:function(t){return t?s()(t).format("MM/DD/YY"):null}},{key:"available_phenotypes",label:"Phenotypes",sortable:!1}],loadingResults:!1,filters:{gene:[],expertPanel:[],classification:[],status:[]},formErrors:[]}},computed:{emptyText:function(){return"Add comma speparated gene symbols in the textarea to do a bulk lookup"},responseGenes:function(){return l(new Set(this.results.map((function(t){return t.gene_symbol}))))},filteredResults:function(){var t=this,e=JSON.parse(JSON.stringify(this.results));return this.filters.gene.length>0&&(e=e.filter((function(e){return t.filters.gene.indexOf(e.gene_symbol)>-1}))),this.filters.expertPanel.length>0&&(e=e.filter((function(e){return t.filters.expertPanel.indexOf(e.expert_panel)>-1}))),this.filters.classification.length>0&&(e=e.filter((function(e){return null!==e.current_classification&&t.filters.classification.indexOf(e.current_classification.name)>-1}))),this.filters.status.length>0&&(e=e.filter((function(e){return null!==e.current_status&&t.filters.status.indexOf(e.current_status.name)>-1}))),e},resultsPanels:function(){if(0==this.results.length)return[];var t=this.results.filter((function(t){return null!==t.expert_panel})).map((function(t){return t.expert_panel.name}));return l(new Set(t))},resultsClassifications:function(){if(0==this.results.length)return[];var t=this.results.filter((function(t){return null!==t.current_classification})).map((function(t){return t.current_classification.name}));return l(new Set(t))},resultsStatuses:function(){if(0==this.results.length)return[];var t=this.results.filter((function(t){return null!==t.current_status})).map((function(t){return t.current_status?t.current_status.name:null}));return l(new Set(t))}},methods:{search:function(){var t=this;this.formErrors=[],this.loadingResults=!0,axios.post("/api/bulk-lookup",{gene_symbol:this.geneSymbols,with:"classifications"}).then((function(e){return t.results=e.data.data,e})).catch((function(e){var n=Object.values(e.response.data.errors).flat();console.log(n),t.formErrors=n})).then((function(e){t.loadingResults=!1}))},addFilter:function(t,e){-1!=Object.keys(this.filters).indexOf(t)?this.filters[t].push(e):alert('Bad filter key. Valid filter keys include: "gene", "expertPanel", "classification", and "status"')},removeFilter:function(t,e){var n=this.filters[t].indexOf(e);if(-1!=n){var r=JSON.parse(JSON.stringify(this.filters[t]));r.splice(n,1),console.log(r),this.$set(this.filters,t,r)}},toggleFilter:function(t,e){this.filters[t].indexOf(e)<0?this.addFilter(t,e):this.removeFilter(t,e)},downloadCsv:function(){var t=this;this.search(),axios.post("/api/bulk-lookup/csv",{gene_symbol:this.geneSymbols,with:"classifications"}).then((function(t){var e=document.createElement("a");e.style.display="none",document.body.appendChild(e),e.href=window.URL.createObjectURL(new Blob([t.data,{type:"text/csv"}])),e.setAttribute("download","bulk-lookup-results.csv"),e.click(),document.body.removeChild(e)})).catch((function(e){var n=Object.values(e.response.data.errors).flat();console.log(n),t.formErrors=n}))},phenotypeIsInCuration:function(t,e){return e.phenotypes.map((function(t){return t.mim_number})).indexOf(t.mim_number)>-1}}},u=(n("+Fwk"),n("KHd+")),f=Object(u.a)(c,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"card"},[t._m(0),t._v(" "),n("div",{staticClass:"card-body"},[n("p",{staticClass:"text-grey"},[t._v("\n            Look up gene precurations and curations by gene symbol.\n        ")]),t._v(" "),t.formErrors.length>0?n("div",{staticClass:"alert alert-danger"},[n("ul",{staticClass:"mb-0"},t._l(t.formErrors,(function(e,r){return n("li",{key:r},[t._v(t._s(e))])})),0)]):t._e(),t._v(" "),n("lookup-form",{staticClass:"mb-3",on:{lookup:t.search,getCsv:t.downloadCsv},model:{value:t.geneSymbols,callback:function(e){t.geneSymbols=e},expression:"geneSymbols"}}),t._v(" "),t.results.length>0?n("div",[n("h5",[t._v("Curations:")]),t._v(" "),n("b-table",{staticClass:"text-small",attrs:{fields:t.fields,items:t.filteredResults,"primary-key":"id",bordered:"","show-empty":"","empty-text":t.emptyText,busy:t.loadingResults,small:!0,striped:""},scopedSlots:t._u([{key:"head(available_phenotypes)",fn:function(e){return[t._v("\n                    "+t._s(e.label)+"\n                    "),n("small",{staticClass:"font-weight-normal"},[t._v("(* phenotype is in curation)")])]}},{key:"cell(available_phenotypes)",fn:function(e){var r=e.item,s=e.value;return[n("ul",{staticClass:"list-unstyled",staticStyle:{"overflow-x":"scroll"}},t._l(s,(function(e){return n("li",{key:e.mim_number,staticClass:"phenotype",class:{curated:t.phenotypeIsInCuration(e,r)}},[t.phenotypeIsInCuration(e,r)?n("span",[t._v("*")]):t._e(),t._v(t._s(e.name)+" ("+t._s(e.mim_number)+")\n                        ")])})),0)]}}],null,!1,2485407782)},[n("div",{staticClass:"text-center",attrs:{slot:"table-busy"},slot:"table-busy"},[t._v("\n                    Looking for curations...\n                ")])])],1):t._e()],1)])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"card-header"},[e("h3",{staticClass:"mb-0"},[this._v("Bulk Curation Lookup")])])}],!1,null,"a7cc2a54",null);e.default=f.exports},gkCk:function(t,e,n){var r=n("CiND");"string"==typeof r&&(r=[[t.i,r,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,s);r.locals&&(t.exports=r.locals)},wCxy:function(t,e,n){"use strict";var r={props:{items:{type:Array,required:!0},title:{type:String,default:"Filter"},selectedFilters:{type:Array,required:!0}}},s=(n("2Xr8"),n("KHd+")),a=Object(s.a)(r,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"mb-3"},[n("h6",[t._v(t._s(t.title))]),t._v(" "),n("ul",{staticClass:"list-group text-small"},t._l(t.items,(function(e){return n("li",{key:e,staticClass:"list-group-item cursor-pointer",class:{selected:t.selectedFilters.includes(e)},on:{click:function(n){return t.$emit("toggle",e)}}},[t.selectedFilters.includes(e)?n("span",{staticClass:"btn btn-sm float-right cursor-pointer"},[t._v("\n                x\n            ")]):t._e(),t._v("\n            "+t._s(e)+"\n        ")])})),0)])}),[],!1,null,null,null);e.a=a.exports},yAls:function(t,e,n){(t.exports=n("I1BE")(!1)).push([t.i,"li.selected{text-decoration:underline;font-weight:700}",""])}}]);
//# sourceMappingURL=BulkLookup.d19a1491b87ebd7f920a.js.map