{
    "$schema": "http://json-schema.org/schema#",
    "$id": "https://gene-tracker.clinicalgenome.org/gene-tracker-curation-stream-schema.json",
    "title": "GeneTracker Event",
    "description": "A message published to the GeneTracker curation stream.",
    "type": "object",
    "properties": {
        "key": {
            "type": "string",
            "pattern": "^\\w{6}(-\\w{4}){3}-\\w{12}$"
        },
        "event_type": {
            "type": "string",
            "title": "Type of curation event",
            "enum": ["created", "updated", "deleted"]
        },
        "schema_version": { "type": "integer" },
        "data": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "integer",
                    "minimum": 1
                },
                "uuid": {
                    "type": "string",
                    "pattern": "^\\w{8}-(\\w{4}-){3}\\w{12}$"
                },
                "gene": {
                    "type": "object",
                    "properties": {
                        "hgnc_id": {
                            "type": "string",
                            "pattern": "^HGNC:[0-9]*$"
                        },
                        "symbol": {
                            "type": "string"
                        }
                    },
                    "required": ["hgnc_id", "symbol"]
                },
                "mondo_id": {
                    "type": "string",
                    "pattern": "^MONDO:[0-9]{7}"
                },
                "mode_of_inheritance": {
                    "type": "object",
                    "properties": {
                        "name": {
                            "type": "string"
                        },
                        "hp_id": {
                            "type": "string",
                            "format": "^HP:[0-9]{7}"
                        }
                    }
                },
                // This structure takes into account the data model for groups in the 
                // forthcoming OrgManager.
                "group": {
                    "type": "object",
                    "properties": {
                        "id": {
                            "type": "string",
                            "pattern": "^\w{6}-(\w{4}-){3}\w{12}"
                        },
                        "name": { "type": "string" },
                        "type": { "type": "string" },
                        "affiliation_id": { "type": "string" },
                        "uri": { "type": "string", "format": "uri" }
                    }
                },
                "curator": {
                    "type": "object",
                    "properties": {
                        "id": { "type": "integer" },
                        "name": { "type": "string" },
                        "email": {
                            "type": "string",
                            "format": "email"
                        },
                        "clingen_id": { "type": "string" }
                    }
                },
                "statuses": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "name": {
                                "type": "string",
                                "enum": [
                                    "uploaded",
                                    "precuration",
                                    "disease entity assigned",
                                    "curation in progress",
                                    "curation provisional",
                                    "curation approved",
                                    "retired assignment",
                                    "published",
                                    "recuration assigned"
                                ],
                                "uniqueItems": false
                            },
                            "effective_date": {
                                "type": "string",
                                "format": "date-time"
                            }
                        },
                        "required": ["name", "effective_date"]
                    }
                },
                "pmids": {
                    "type": "array",
                    "items": {
                        "type": "integer",
                        "uniqueItems": true
                    }
                },
                // Should we re-structure to object w/ list of rationale categories, list of PMIDs, and rationale text
                // Change to list of objects w/ rationale id and name
                "rationales": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "enum": []
                    }
                },
                "curation_type": {
                    "type": "object",
                    "properties": {
                        "name": {
                            "type": "string",
                            "enum": [
                                "single-omim",
                                "single-new",
                                "isolated-phenotype",
                                "lumped"
                            ]
                        },
                        "description": { "type": "string" }
                    }
                },
                // Should we track both included and excluded phenotypes?
                // Should it depend on the curation-type?
                "omim_phenotypes": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "pattern": "^\\d{7}$"
                    }
                },
                // Alternative
                // "omim_phenotypes": {
                //     "type": "object",
                //     "properties": {
                //         "included": {
                //             "type": "array",
                //             "items": {
                //                 "type": "string",
                //                 "pattern": "^\\d{7}$"
                //             }
                //         },
                //         "excluded": {
                //             "type": "array",
                //             "items": {
                //                 "type": "string",
                //                 "pattern": "^\\d{7}$"
                //             }        
                //         }
                //     } 
                // },
            }
        }
    },
    "required": ["id", "gene"]
}